# Keyman for Windows: Distributed Installation of Keyboards

## Installing Keyman Package Files using kmshell.exe

**Introduction:**
This knowledge base provide the steps to to install keyboards remotely and enable them for a non-elevated user. The key is that the registration for language and the keyboard needs to be run as the user who needs the keyboard enabled.

This guide will use `kmshell.exe` and will work for Keyman 14 and above.

4. **Locating `kmshell.exe`:**
   - Typically, `kmshell.exe` is located in `%ProgramFiles(x86)%\Keyman\Keyman Desktop\kmshell.exe`.
   - Alternatively, the path can be retrieved from the registry setting `HKLM\Software\WOW6432Node\Keyman\Keyman Desktop\root`.

**Procedure:**

1. **Keyboard Package Installation:**
   - Execute the following command in an elevated command prompt to install the package and make it available for all users:
     ```
     kmshell -s -i filename.kmp
     ```

2. **Language registration for each user:**
   - With Keyman 14 and above, an extra step is necessary for each user to set up language registration for the keyboard within the package.
   - Run the following command in a non-elevated command prompt for each user:
     ```
     kmshell -s -ikl KeyboardID BCP47Tag
     ```
     - Replace 'KeyboardID' with the appropriate identifier for the keyboard (usually the same as the package filename without `.kmp`).
     - Replace 'BCP47Tag' with the language tag, which can be found in Keyman Configuration.

3. **Example:**
   - As an example, let's consider the installation of the BJ-OjiCree keyboard (Kingfisher):
     - KeyboardID: `bj_cree_east`
     - BCP47Tag: `crl-Cans-CA`
   - Installation commands:
     - Elevated session:
       ```
       kmshell -s -i bj_cree_east.kmp.kmp
       ```
     - Non-elevated session (for each user):
       ```
       kmshell -s -ikl bj_cree_east crl-Cans-CA
       ```


**Automation:**
- Incorporating these installation steps with remote deployment and management software tools should achieve automation
